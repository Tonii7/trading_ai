# Eldar — TradingAI Technical Intelligence Book  
## Section 11 — Developer Guide (Startup Style)  
(Руководство для разработчиков: простое и практичное)

---

## Введение

Это раздел в стиле **стартап-документации**, ориентированный на:

- новичков в проекте TradingAI  
- помощников/разработчиков  
- будущих сотрудников  
- тебя самого, чтобы быстро вспоминать как всё работает  

Документ описывает:

- как ориентироваться в проекте  
- как запускать сервисы  
- как добавлять новых агентов  
- как расширять систему  
- как проводить отладку  

TradingAI достаточно сложная архитектура, но её можно понять быстро, если следовать этому гайду.

---

# 11.1. Как ориентироваться в проекте (главное правило)

### Правило №1 — всё находится в `/src/trading_ai`
Это сердце проекта:

```
src/trading_ai/
├── agents/
├── services/
├── config/
├── setup/
├── run_crew.py
├── (файлы запусков)
```

### Правило №2 — сервисы и агенты разделены жёстко
- Agents = логика анализа  
- Services = data providers  

### Правило №3 — все настройки централизованы
Конфигурация в:

```
src/trading_ai/config/output_routes.yaml
```

---

# 11.2. Как запустить систему (короткая инструкция)

Открыть PowerShell:

```
cd C:\Users\Win11\Desktop\trading_ai
.\venv\Scripts\Activate.ps1
```

Запустить Discord Bot:

```
run_discord_bot.bat
```

Запустить CrewAI:

```
python src/trading_ai/run_crew.py
```

Запустить Market Engine:

```
python src/trading_ai/run_market_engine.py
```

---

# 11.3. Как работает логика команд

Вся обработка команд Discord реализована в:

```
src/trading_ai/services/discord/
```

**Принцип:**

1. Discord → handlers.py  
2. handlers → Crew Dispatcher  
3. Crew Dispatcher → Supervisor  
4. Supervisor → Аналитические агенты  
5. Результат → обратно в Discord  

---

# 11.4. Как добавить нового агента в систему

### Шаг 1 — создать файл:
```
src/trading_ai/agents/my_new_agent.py
```

### Шаг 2 — определить класс агента:

```python
class MyNewAgent:
    name = "my_new_agent"

    def run(self, context):
        # логика анализа
        return {"result": "ok"}
```

### Шаг 3 — зарегистрировать агента в Supervisor  
Добавить импорт + включить в список агентов.

### Шаг 4 — протестировать через Discord  
Команда:

```
/test_agent my_new_agent
```

Если всё работает — агент интегрирован.

---

# 11.5. Как добавить новый сервис

### Шаг 1 — создать папку:
```
src/trading_ai/services/my_service/
```

### Шаг 2 — добавить файл:
```
logic.py
utils.py
```

### Шаг 3 — добавить маршруты в Discord (если нужно).

### Шаг 4 — расширить output_routes.yaml (если сервис отдаёт данные).

---

# 11.6. Как работать с конфигурацией (output_routes.yaml)

Файл:

```
src/trading_ai/config/output_routes.yaml
```

Пример:

```yaml
discord:
  reports_channel: 123456789
  logs_channel: 987654321

files:
  enable: true
```

Этот файл определяет **куда система отправляет результаты**.

---

# 11.7. Как работать с логами и отчётами

Логи:

```
reports/
ABSOLUTE_DEBUG.txt
src/reports/
```

Рекомендация:

- просматривать jsonl-файлы через VS Code  
- группировать отчёты  
- сохранять интересные файлы в knowledge/  

---

# 11.8. Как добавить новый модуль анализа рынка

Если нужно добавить движок для другой торговой сессии (например, Tokyo), алгоритм:

### 1. Создаёшь новый модуль:
```
services/tokyo_session/
```

### 2. Копируешь базовую структуру из NY Session Engine  
### 3. Настраиваешь получение свечей  
### 4. Настраиваешь логи  
### 5. Добавляешь интеграцию в CrewAI  
### 6. Включаешь в Discord командой:

```
/tokyo_session
```

---

# 11.9. Ошибки — где искать причину

| Где искать | Что означает |
|-----------|--------------|
| `ABSOLUTE_DEBUG.txt` | ошибки системного уровня |
| `reports/*.jsonl` | ошибки анализа |
| терминал Discord Bot | ошибки взаимодействия |
| CrewAI консоль | проблемы агентов |
| cTrader API log | ошибки брокера |

---

# 11.10. Как обновлять систему из GitHub

Если ты внес изменения:

```
git add .
git commit -m "update"
git push
```

Если ты хочешь скачать обновления:

```
git pull
```

---

# 11.11. Что делать если что-то сломалось

1. Проверить .env  
2. Проверить токен Discord  
3. Проверить права бота  
4. Проверить output_routes.yaml  
5. Проверить cTrader учетные данные  
6. Перезапустить бота  
7. Перезапустить CrewAI  
8. Проверить логи  

---

# 11.12. Мини-гайд по навигации (самое важное)

| Что нужно найти | Где лежит |
|------------------|-----------|
| Логика агентов | `/agents` |
| Работа cTrader | `/services/ctrader` |
| Discord | `/services/discord` |
| НЙ Сессия | `/services/NY Session` |
| Настройки | `/config` |
| Логи | `/reports` |
| Запуск | `run_*.py` + `.bat` |

---

# Финальные рекомендации

Документ предназначен для:

- быстрого включения нового разработчика  
- твоей собственной оперативной навигации  
- структурирования знаний для NotebookLM  

TradingAI будет расти — Developer Guide станет основой будущей команды.
